function SmartStorage(a){if(SmartStorage.browserIsSupported())this.dbname=a}SmartStorage.prototype._setItemForDb=function(a,b,c){b=JSON.stringify(b);c&&(b=(new Date).getTime()+c+"--cache--"+b);return localStorage.setItem(this.dbname+"_"+a,b)};SmartStorage.prototype._getItemForDb=function(a){(a=localStorage.getItem(this.dbname+"_"+a))&&(a=SmartStorage.getCachableValue(a));return JSON.parse(a)};SmartStorage.prototype._removeItemForDb=function(a){return localStorage.removeItem(this.dbname+"_"+a)};
SmartStorage.prototype.set=function(a,b,c,d){if(arguments.length<2)throw"SmartStorage error: set() requires at least 2 arguments.";if(SmartStorage.typeOf(b)==="function")throw"SmartStorage error: Can't store function reference.";return this._setItemForDb(a,b,c,d)};SmartStorage.prototype.get=function(a,b){if(arguments.length<1)throw"SmartStorage error: get() requires 1 argument.";return this._getItemForDb(a,b)};
SmartStorage.getCachableValue=function(a){a.indexOf("--cache--")>-1&&(a=a.split("--cache--"),a=(new Date).getTime()>a[0]?null:a[1]);return a};SmartStorage.browserIsSupported=function(){try{return"localStorage"in window&&window.localStorage!==null}catch(a){return!1}};SmartStorage.typeOf=function(a){var b=typeof a;b==="object"&&(a?a instanceof Array?b="array":a instanceof String&&(b="string"):b="null");return b};